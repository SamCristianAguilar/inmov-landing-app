<div class="p-3">
  <div class="theme-container">
    <mat-card ngClass.lt-lg="p-0" [formGroup]="submitForm">
      <mat-horizontal-stepper #horizontalStepper linear="true" class="submit-property" (selectionChange)="onSelectionChange($event)">

        <mat-step [stepControl]="this.submitForm.get('location')" label="Ubicación">
          <div class="step-content">
            <form formGroupName="location" fxLayout="row wrap">
              <div fxFlex="100" class="p-3">
                <h1 class="fw-500 text-center">Ubicación</h1>
              </div>

              <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-select  formControlName="departament" placeholder="Departamento" (selectionChange)="onSelectCity()" #singleSelect>
                    <mat-option>
                      <ngx-mat-select-search formControlName="departamentFilter" placeholderLabel="Buscar departamento..." ></ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let departament of filteredDepartaments | async" [value]="departament">
                      {{departament.name}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-select  formControlName="city" placeholder="Ciudad"  #singleSelect>
                    <mat-option>
                      <ngx-mat-select-search formControlName="cityFilter" placeholderLabel="Buscar ciudad..." ></ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let city of filteredCities | async" [value]="city">
                      {{city.name}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <!-- <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>City</mat-label>
                                    <mat-select placeholder="Select City..." formControlName="city" (selectionChange)="onSelectCity()" required="required">
                                        <mat-option *ngFor="let city of cities" [value]="city">
                                            {{ city.name }}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="submitForm.get('data')['address']['controls'].city.errors?.required"> City is required </mat-error>
                                </mat-form-field>
                            </div>

                            <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Zip Code</mat-label>
                                    <input matInput="matInput" placeholder="exp. 98104" autocomplete="off" formControlName="zipCode" />
                                </mat-form-field>
                            </div>

                            <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Neighborhood</mat-label>
                                    <mat-select placeholder="Select Neighborhood..." formControlName="neighborhood" multiple="multiple" (selectionChange)="onSelectNeighborhood()">
                                        <mat-option *ngFor="let neighborhood of neighborhoods | filterNeighborhoods: submitForm.get('data')['address']['controls'].city.value?.id" [value]="neighborhood">
                                            {{ neighborhood.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <div fxFlex="100" fxFlex.gt-xs="50" class="px-2">
                                <mat-form-field appearance="outline" class="w-100">
                                    <mat-label>Street</mat-label>
                                    <mat-select placeholder="Select Street..." formControlName="street" multiple="multiple">
                                        <mat-option *ngFor="                        let street of streets
                          | filterStreets: { neighborhoods: submitForm.get('data')['address']['controls'].neighborhood.value?.id, cityId: submitForm.get('data')['address']['controls'].city.value?.id }
                      " [value]="street">
                                            {{ street.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div> -->

              <div fxFlex="100" class="mt-3 p-2" fxLayoutAlign="space-between center">
                <button mat-raised-button="mat-raised-button" color="primary" matStepperPrevious="matStepperPrevious" fxLayout="row" fxLayoutAlign="center center" type="button">
                  <mat-icon>navigate_before</mat-icon>
                  <span class="mx-1 uppercase">Back</span>
                </button>
                <button mat-raised-button="mat-raised-button" color="primary" matStepperNext="matStepperNext" fxLayout="row" fxLayoutAlign="center center" type="button">
                  <span class="mx-1 uppercase">Next</span>
                  <mat-icon>navigate_next</mat-icon>
                </button>
              </div>
            </form>
          </div>
        </mat-step>

        <mat-step label="Confirmation">
          <div class="step-content">
            <div fxLayout="column" fxLayoutAlign="center center" class="pt-5 text-center">
              <button mat-fab="mat-fab" color="primary">
                <mat-icon>check</mat-icon>
              </button>
              <h2 class="mt-3 uppercase">Congratulation!</h2>
              <h2 class="my-3">
                Your property
                <span class="primary-color"> "{{ submitForm.get("basic")["controls"].title.value }}" </span> has been submitted
              </h2>
              <p class="text-muted">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed tempus dolor ante, ut luctus mi faucibus a. Ut eu tincidunt neque. Proin porttitor id ligula id placerat. Integer nec nulla
                varius, dapibus libero quis, semper eros. Aliquam erat volutpat. Proin volutpat tellus vel purus interdum euismod.
              </p>
            </div>
            <div fxLayout="row" fxLayoutAlign="center center" class="pt-3">
              <button mat-raised-button="mat-raised-button" color="accent" (click)="reset()" type="button">Return to submit new property</button>
            </div>
          </div>
        </mat-step>
      </mat-horizontal-stepper>
    </mat-card>
  </div>
</div>
